# Derivatives (Perps / Options) Schema

This is the OpenBlock Labs standard schema for derivatives protocols (options and perps).

## Schema

### Pools

**Description:** Pools in the protocol (one entry for each token).

| Property            | Description                                        | Type   |
|---------------------|----------------------------------------------------|--------|
| chain_id            | Standard chain id.                                 | number |
| creation_timestamp  | The timestamp of the block the pool was created on.| number |
| creation_block_number | The block number this pool was created on.       | number |
| pool_address        | The contract address of the pool.                  | string |
| token_index         | The index of the token in the smart contract (one row for each token in a pool). | number |
| token_address       | The contract address of the token.                 | string |
| token_symbol        | The symbol of the token.                           | string |

### LP Snapshot

**Description:** Liquidity providers snapshot (one entry for each token in a pool).

| Property          | Description                                           | Type   |
|-------------------|-------------------------------------------------------|--------|
| timestamp         | The timestamp of the snapshot.                        | number |
| chain_id          | Standard chain id.                                    | number |
| pool_address      | The address of the pool.                              | string |
| lp_address        | The address of the liquidity provider.                | string |
| token_index       | The index of the token in the smart contract.         | number |
| token_address     | The address of the token provided as liquidity.       | string |
| token_symbol      | The symbol of the token.                              | string |
| token_amount      | The amount of tokens, decimal normalized.             | number |
| token_amount_usd  | (Optional) The amount of the provided token in USD.   | number |
| total_fees_usd    | (Optional) All fees generated by the LP in the given snapshot in USD. | number |
| user_fees_usd     | (Optional) The portion of fees accrued to users of the protocol, in USD. | number |
| protocol_fees_usd | (Optional) The portion of fees accrued to the protocol, in USD. | number | 

### Maker Snapshot

**Description:** User level maker snapshot (one entry for each token in a pool).

| Property          | Description                                           | Type   |
|-------------------|-------------------------------------------------------|--------|
| timestamp         | The timestamp of the snapshot.                        | number |
| chain_id          | Standard chain id.                                    | number |
| pool_address      | The address of the pool.                              | string |
| maker_address     | The address of the user/maker.                        | string |
| token_index       | The index of the token in the smart contract.         | number |
| token_address     | The address of the token provided as liquidity.       | string |
| token_symbol      | The symbol of the token.                              | string |

### Taker Snapshot

**Description:** User level taker snapshot (one entry for each token in a pool).

| Property          | Description                                           | Type   |
|-------------------|-------------------------------------------------------|--------|
| timestamp         | The timestamp of the snapshot.                        | number |
| chain_id          | Standard chain id.                                    | number |
| pool_address      | The address of the pool.                              | string |
| taker_address     | The address of the user/taker.                        | string |
| token_index       | The index of the token in the smart contract.         | number |
| token_address     | The address of the token provided as liquidity.       | string |
| token_symbol      | The symbol of the token.                              | string |

### Pool Snapshot

| Property                | Description                                                           | Type   |
|-------------------------|-----------------------------------------------------------------------|--------|
| timestamp               | The timestamp of the snapshot.                                        | number |
| chain_id                | Standard chain id.                                                    | number |
| pool_address            | The smart contract address of the pool.                               | string |
| funding_rate            | The funding rate in this pool at the time of the snapshot, as a percentage. | number |
| fee_rate                | The pool's fee rate, as a percentage.                                 | number |
| total_value_locked_usd  | (Optional) The total value locked in USD.                             | number |
| open_interest_longs_usd | (Optional) The open interest of longs in USD.                         | number |
| open_interest_shorts_usd| (Optional) The open interest of shorts in USD.                        | number |

### Trades

| Property            | Description                                         | Type   |
|---------------------|-----------------------------------------------------|--------|
| timestamp           | The timestamp of the trade.                         | number |
| chain_id            | Standard chain id.                                  | number |
| transaction_hash    | The hash of the transaction this trade was performed in. | string |
| block_number        | The block number of the trade.                      | number |
| pool_address        | The address of the pool this token was traded in.   | string |
| maker_address       | The address of the maker.                           | string |
| taker_address       | The address of the taker.                           | string |
| token_address       | The address of the token.                           | string |
| amount              | The amount of the token traded, decimal normalized. | number |
| amount_usd          | (Optional) The trade amount in USD.                 | number |
| pnl_usd             | (Optional) The total profit and loss of the trade in USD.      | number |
