- TODO: is amount in / out correctly used?